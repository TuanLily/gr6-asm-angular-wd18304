"use strict";(self.webpackChunkASM=self.webpackChunkASM||[]).push([[281],{281:(B,m,s)=>{s.r(m),s.d(m,{FeedbackModule:()=>q});var a=s(9015),b=s(5053),c=s(2823),p=s(2617),C=s(4004),k=s(1005),e=s(4650),f=s(529);let v=(()=>{class o{constructor(t){this.http=t}load(t,n){const r=(t-1)%7*n;return this.http.get("assets/data/news.json").pipe((0,C.U)(d=>d.splice(r,n)),(0,k.g)(1500))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var u=s(923);let F=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["ngx-components"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[u.lC],encapsulation:2}),o})();var E=s(5226),M=s.n(E),l=s(4641),Z=s(8135);let T=(()=>{class o extends Z.s{constructor(t){super(t),this._http=t}getAllFeedbacks(t,n=""){const r={page:t.toString(),search:n};return this.get(l.C+l.Q.feedback,r)}addFeedback(t){return this.post(l.C+l.Q.feedback,t)}updateFeedback(t,n){return this.patch(`${l.C+l.Q.feedback}/${t}`,n)}deleteFeedback(t){return this._http.delete(`${l.C+l.Q.feedback}/${t}`)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var O=s(8315),P=s(5515),h=s(6895),y=s(5547);const A=["formElement"];function S(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",31),e._uU(2),e.qZA(),e.TgZ(3,"td",31),e._uU(4),e.qZA(),e.TgZ(5,"td",31),e._uU(6),e.qZA(),e.TgZ(7,"td",31),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",32)(11,"div",33)(12,"button",34),e.NdJ("click",function(){const d=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.editFeedback(d.id))}),e._UZ(13,"i",35),e.qZA(),e.TgZ(14,"button",36),e.NdJ("click",function(){const d=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.deleteFeedback(d.id))}),e._UZ(15,"i",37),e.qZA()()()()}if(2&o){const t=i.$implicit,n=i.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.customer_name),e.xp6(2),e.Oqu(t.content),e.xp6(2),e.Oqu(e.xi3(9,4,t.create_date,"dd/MM/yyyy HH:mm:ss"))}}function x(o,i){if(1&o&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function U(o,i){1&o&&(e.TgZ(0,"div",39)(1,"small"),e._uU(2,"Vui l\xf2ng ch\u1ecdn m\u1ed9t t\xe0i kho\u1ea3n."),e.qZA()())}function N(o,i){1&o&&(e.TgZ(0,"small"),e._uU(1,"Vui l\xf2ng nh\u1eadp \u0111\xe1nh gi\xe1."),e.qZA())}function L(o,i){if(1&o&&(e.TgZ(0,"div",39),e.YNc(1,N,2,0,"small",40),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.form.get("content").hasError("required"))}}const J=[{path:"",component:F,children:[{path:"list",component:(()=>{class o{constructor(t,n,r,d,g,w,D){this.toastrService=t,this.feedbackService=n,this.customerService=r,this.themeService=d,this.spinner=g,this.router=w,this.route=D,this.newFeedback={content:"",customer_id:"",create_date:""},this.isAddingNewFeedback=!0,this.isEditing=!1,this.feedbacks=[],this.customerData=[],this.apiUrl=l.C+l.Q.feedback,this.currentPage=1,this.searchQuery="",this.themes=[{value:"default",name:"Light"},{value:"dark",name:"Dark"}],this.currentTheme="default",this.themeService.onThemeChange().subscribe(I=>{this.currentTheme=I.name})}ngOnInit(){this.loadCustomers(),this.route.queryParams.subscribe(t=>{this.loadFeedbacks(t.page||1)}),this.form=new a.cw({content:new a.NI("",a.kI.required),customer_id:new a.NI("",a.kI.required)})}loadFeedbacks(t){this.spinner.show(),this.feedbackService.getAllFeedbacks(t,this.searchQuery).subscribe(n=>{this.spinner.hide(),this.feedbacks=n.feedback,this.currentPage=n.currentPage,this.totalPages=n.totalPages;const r={page:t};this.searchQuery&&""!==this.searchQuery.trim()&&(r.search=this.searchQuery),this.router.navigate([],{queryParams:r,replaceUrl:!0})})}loadCustomers(t=1,n=""){this.customerService.getAllCustomers(t,n).subscribe(r=>{console.log(r),this.customerData=r.customers},r=>{console.error("Error loading customers:",r),this.toastrService.danger("\u0110\xe3 x\u1ea3y ra l\u1ed7i khi t\u1ea3i kh\xe1ch h\xe0ng!","Error")})}onSearch(){this.loadFeedbacks(this.currentPage)}addFeedback(){if(!this.form.valid)return void this.toastrService.danger("Vui l\xf2ng nh\u1eadp \u0111\u1ee7 d\u1eef li\u1ec7u v\xe0 ki\u1ec3m tra l\u1ea1i c\xe1c tr\u01b0\u1eddng!","Error");let t={content:this.form.get("content").value,customer_id:this.form.get("customer_id").value};if(this.isEditing&&!this.isAddingNewFeedback){const n=this.newFeedback.id;console.log(n),this.feedbackService.updateFeedback(n,t).subscribe(()=>{this.toastrService.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!","Success"),this.isEditing=!1,this.spinner.hide(),this.loadFeedbacks(this.currentPage)},r=>{this.toastrService.danger("\u0110\xe3 x\u1ea3y ra l\u1ed7i khi c\u1eadp nh\u1eadt \u0111\xe1nh gi\xe1!","Error"),console.error("Error updating feedback:",r),this.spinner.hide()})}else this.feedbackService.addFeedback(t).subscribe(()=>{this.toastrService.success("Th\xeam m\u1edbi th\xe0nh c\xf4ng!","Success"),this.spinner.hide(),this.loadFeedbacks(1)},n=>{this.toastrService.danger("\u0110\xe3 x\u1ea3y ra l\u1ed7i khi th\xeam \u0111\xe1nh gi\xe1!","Error"),console.error("Error adding feedback:",n),this.spinner.hide()});this.form.reset()}editFeedback(t){var n;if(this.isEditing)return;const r=this.feedbacks.findIndex(d=>d.id===t);-1!==r&&(this.newFeedback=Object.assign({},this.feedbacks[r]),this.form.patchValue({content:this.newFeedback.content,customer_id:this.newFeedback.customer_id}),null===(n=this.form.get("customer_id"))||void 0===n||n.disable(),this.isAddingNewFeedback=!1,this.isEditing=!0,this.toastrService.info("S\u1eb5n s\xe0ng c\u1eadp nh\u1eadt!","Th\xf4ng tin")),this.scrollFormIntoView()}deleteFeedback(t){M().fire({title:"X\xe1c nh\u1eadn x\xf3a",text:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a \u0111\xe1nh gi\xe1 n\xe0y?",icon:"warning",showCancelButton:!0,confirmButtonText:"\u0110\u1ed3ng \xfd",cancelButtonText:"H\u1ee7y b\u1ecf"}).then(n=>{n.isConfirmed&&this.feedbackService.deleteFeedback(t).subscribe(()=>{const r=this.feedbacks.findIndex(d=>d.id===t);-1!==r&&(this.feedbacks.splice(r,1),this.toastrService.success("X\xf3a th\xe0nh c\xf4ng!","Success"))},r=>{this.toastrService.danger("\u0110\xe3 x\u1ea3y ra l\u1ed7i khi x\xf3a \u0111\xe1nh gi\xe1!","Error"),console.error("Error deleting feedback:",r)})})}Reset(){var t;this.isEditing=!1,this.isAddingNewFeedback=!0,this.form.reset(),null===(t=this.form.get("customer_id"))||void 0===t||t.enable(),this.toastrService.success("D\u1eef li\u1ec7u tr\xean form \u0111\xe3 \u0111\u01b0\u1ee3c reset!","Th\xe0nh c\xf4ng")}scrollFormIntoView(){this.formElement&&this.formElement.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(c.quB),e.Y36(T),e.Y36(O.v),e.Y36(c.WMF),e.Y36(P.V),e.Y36(u.F0),e.Y36(u.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(A,5),2&t){let r;e.iGM(r=e.CRH())&&(n.formElement=r.first)}},decls:63,vars:13,consts:[[3,"ngClass"],[1,"d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-0"],[1,"d-flex",3,"ngSubmit"],["type","search","placeholder","T\xecm ki\u1ebfm","name","searchQuery","aria-label","Search",1,"form-control","me-2",3,"ngModel","ngModelChange"],["type","submit","nbButton","","status","primary"],[1,"fa-solid","fa-magnifying-glass"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[4,"ngFor","ngForOf"],[3,"apiUrl","current_page","last_page","dataList"],[1,"mt-3",3,"ngClass"],[1,"card-title"],[3,"formGroup","ngSubmit"],["feedbackForm","ngForm","formElement",""],[1,"row"],[1,"col-md-6"],[1,"form-group","my-3"],["for","customerOption",1,"my-1"],[1,"spot"],["id","customerOption","formControlName","customer_id",1,"form-control"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"col-md-12"],["for","feedbackContent",1,"my-1"],["id","feedbackContent","name","feedbackContent","rows","3","formControlName","content",1,"form-control",3,"ngModel","ngModelChange"],["nbButton","","type","submit","status","success","nbTooltip","L\u01b0u d\u1eef li\u1ec7u",1,"float-end",3,"disabled"],[1,"fa-solid","fa-check"],["nbButton","","status","warning","type","button","nbTooltip","Reset d\u1eef li\u1ec7u",1,"float-end","mx-2",3,"click"],[1,"fas","fa-rotate-left"],[1,"align-middle"],[1,"align-middle","text-center"],[1,"btn-group"],["nbButton","","status","primary","type","button","nbTooltip","S\u1eeda d\u1eef li\u1ec7u",1,"btn-sm","mr-2","mx-1",3,"click"],[1,"fa-solid","fa-pen-to-square"],["nbButton","","status","danger","type","button","nbTooltip","X\xf3a d\u1eef li\u1ec7u",1,"btn-sm",3,"click"],[1,"fa-solid","fa-trash"],[3,"value"],[1,"text-danger"],[4,"ngIf"]],template:function(t,n){1&t&&(e.TgZ(0,"nb-card",0)(1,"nb-card-header",1)(2,"h5",2),e._uU(3,"Danh s\xe1ch \u0111\xe1nh gi\xe1"),e.qZA(),e.TgZ(4,"form",3),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(5,"input",4),e.NdJ("ngModelChange",function(d){return n.searchQuery=d}),e.qZA(),e.TgZ(6,"button",5),e._UZ(7,"i",6),e.qZA()()(),e.TgZ(8,"nb-card-body")(9,"div",7)(10,"table",8)(11,"thead")(12,"tr")(13,"th"),e._uU(14,"#"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"T\xean kh\xe1ch h\xe0ng"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"N\u1ed9i dung"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Ng\xe0y t\u1ea1o"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Thao t\xe1c"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,S,16,7,"tr",9),e.qZA()(),e.TgZ(25,"ngx-paginator",10),e.NdJ("dataList",function(d){return n.loadFeedbacks(d)}),e.qZA()()()(),e.TgZ(26,"nb-card",11)(27,"nb-card-header")(28,"h5",12),e._uU(29,"Th\xeam / C\u1eadp nh\u1eadt \u0111\xe1nh gi\xe1"),e.qZA()(),e.TgZ(30,"nb-card-body")(31,"form",13,14),e.NdJ("ngSubmit",function(){return n.addFeedback()}),e.TgZ(34,"div",15)(35,"div",16)(36,"div",17)(37,"label",18),e._uU(38,"Danh s\xe1ch t\xe0i kho\u1ea3n"),e.TgZ(39,"span",19),e._uU(40,"*"),e.qZA(),e._uU(41,":"),e.qZA(),e.TgZ(42,"select",20)(43,"option",21),e._uU(44,"Vui l\xf2ng ch\u1ecdn t\xe0i kho\u1ea3n"),e.qZA(),e.YNc(45,x,2,2,"option",22),e.qZA(),e.YNc(46,U,3,0,"div",23),e.qZA()()(),e.TgZ(47,"div",15)(48,"div",24)(49,"div",17)(50,"label",25),e._uU(51,"\u0110\xe1nh gi\xe1"),e.TgZ(52,"span",19),e._uU(53,"*"),e.qZA(),e._uU(54,":"),e.qZA(),e.TgZ(55,"textarea",26),e.NdJ("ngModelChange",function(d){return n.newFeedback.content=d}),e.qZA(),e.YNc(56,L,2,1,"div",23),e.qZA()()(),e.TgZ(57,"div",15)(58,"div",24)(59,"button",27),e._UZ(60,"i",28),e.qZA(),e.TgZ(61,"button",29),e.NdJ("click",function(){return n.Reset()}),e._UZ(62,"i",30),e.qZA()()()()()()),2&t&&(e.Q6J("ngClass",n.currentTheme),e.xp6(5),e.Q6J("ngModel",n.searchQuery),e.xp6(19),e.Q6J("ngForOf",n.feedbacks),e.xp6(1),e.Q6J("apiUrl",n.apiUrl)("current_page",n.currentPage)("last_page",n.totalPages),e.xp6(1),e.Q6J("ngClass",n.currentTheme),e.xp6(5),e.Q6J("formGroup",n.form),e.xp6(14),e.Q6J("ngForOf",n.customerData),e.xp6(1),e.Q6J("ngIf",n.form.get("customer_id").invalid&&n.form.get("customer_id").touched),e.xp6(9),e.Q6J("ngModel",n.newFeedback.content),e.xp6(1),e.Q6J("ngIf",n.form.get("content").invalid&&n.form.get("content").touched),e.xp6(3),e.Q6J("disabled",!n.form.valid))},dependencies:[a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.On,a.F,a.sg,a.u,h.mk,h.sg,h.O5,c.Asz,c.yKW,c.ndF,c.DPz,c.jNv,y.J,h.uU],styles:[".spot[_ngcontent-%COMP%]{color:red}.light[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{background-color:#fff;color:#000}.light[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{background-color:transparent}.light[_ngcontent-%COMP%]   .table-bordered[_ngcontent-%COMP%]{border:1px solid #dee2e6}.light[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#000;border-color:#dee2e6}.light[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.light[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-color:#dee2e6}.light[_ngcontent-%COMP%]   .badge-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.light[_ngcontent-%COMP%]   .badge-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.light[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#000;border-color:#dee2e6}.dark[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{background-color:#222b45;color:#fff}.dark[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{background-color:transparent}.dark[_ngcontent-%COMP%]   .table-bordered[_ngcontent-%COMP%]{border:1px solid #3b426b}.dark[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#2e3a59;color:#fff;border-color:#3b426b}.dark[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#3b426b}.dark[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#222b45;color:#fff;border-color:#3b426b}.dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#192038;color:#fff;border-color:#111426}.dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder{color:#8590a8}"]}),o})(),data:{breadcrumb:"Danh S\xe1ch"}}]}];let Q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(J),u.Bz]}),o})(),q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[v],imports:[a.u5,a.UX,p.O,c.EoG,c._WB,c.obu,c.zyh,c.BW0,c.T2N,c.COg,c.PYG,c.MfT,c.nKr,c.SDF,c.oGl,c.AE1,c.rgH,Q,c.rgH,b.U]}),o})()}}]);